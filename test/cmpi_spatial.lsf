#!/bin/csh
#
# Sample batch script for an MPI job using ChaMPIon/Pro on Tungsten cluster.
#
#  Submit this script using the command:   bsub < cmpi.lsf
#  [NOTE THE "<" SIGN in the above command]
#
#  Use the "bjobs" command to check the status of a job.
#
#  The following are embedded options. The syntax is #BSUB (the # 
#  does -not- denote that the lines are commented out so do not remove).

#BSUB -n 4              # Specify 4 processes
#BSUB -W 0:02           # Specify job run time limit of 1 hour
#BSUB -o testjob.%J.o   # Store the standard output and standard error of the
                        # job in file testjob.jobid.o (optional)
#BSUB -q debug
#BSUB -J acorrelate     # Specify job name (optional)
# End of embedded BSUB options
#

# cd $SCR                                 # Change to job scratch directory

# msscmd cd test,get a.out,get test.input # Get the files a.out and test.input
                                        # from directory test in UniTree

# chmod u+x a.out                         # Since UniTree gives you the same
                                        # permissions as what your umask is
                                        # set to (generally only read and
                                        # write), you need to give yourself
                                        # executable permission to run a.out

#  soft add +mpich-tcp-1.2.6-intel9

# mpirun -np $NPROCS -machinefile $LSB_NODEFILE acorrelate
cmpirun -lsf correlate sparams.in   # Run executable

# msscmd cd test, put test.output       # Put output file generated by run in
                                        # UniTree
